<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="css/main.css">
    <title>Chores</title>
</head>

<body>
    <div id="message" class="alert alert-light" role="alert">
        Surprised you caught this loading message... Is javascript running?
    </div>

    <nav id="header" class="navbar navbar-light d-none">
        <div class="container">
            <h1 class="navbar-brand">Chores - <span id="room-name">Room Name</span></h1>
        </div>
    </nav>

    <div id="content" class="container d-none">

        <h3>This week <span id="days-left" class="badge rounded-pill bg-secondary">3 days left</span></h3>
        <div id="current-tasks" class="row row-cols-3 row-cols-md-6 g-4 mb-4">
            <div class="col">
                <h5>Bathroom</h5>
                <p>John</p>
            </div>
            <div class="col">
                <h5>Kitchen</h5>
                <p>Arjun</p>
            </div>
            <div class="col">
                <h5>Floor</h5>
                <p>Mary</p>
            </div>
        </div>

        <h3>Last week</h3>
        <div id="previous-tasks" class="row row-cols-3 row-cols-md-6 g-4 mb-4">
            <div class="col">
                <h5>Bathroom</h5>
                <p>John</p>
            </div>
            <div class="col">
                <h5>Kitchen</h5>
                <p>Arjun</p>
            </div>
            <div class="col">
                <h5>Floor</h5>
                <p>Mary</p>
            </div>
        </div>

        <h3>Next week</h3>
        <div id="next-tasks" class="row row-cols-3 row-cols-md-6 g-4 mb-4">
            <div class="col">
                <h5>Bathroom</h5>
                <p>John</p>
            </div>
            <div class="col">
                <h5>Kitchen</h5>
                <p>Arjun</p>
            </div>
            <div class="col">
                <h5>Floor</h5>
                <p>Mary</p>
            </div>
        </div>

    </div>
    <script src="bootstrap/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>

    <script>
        let params;
        const messageElement = document.getElementById("message");
        try {
            params = parseParams();
            if (!validateParams(params)) {
                throw new ParseError("What did you pass through as parameters? Something seems wrong.");
            }
        } catch (err) {
            if (err instanceof ParseError) {
                messageElement.innerHTML = `${err.message}`;
            } else {
                messageElement.innerHTML = `How did you break things? Let me know! Error: ${err.message}`;
            }
            console.error(`${err.message}`);
            throw err;
        }

        document.getElementById("message").classList.add("d-none");
        document.getElementById("header").classList.remove("d-none");
        document.getElementById("content").classList.remove("d-none");

        const assigner = new ChoreAssigner(params);
        document.getElementById("room-name").innerHTML = params.roomName;
        updateTasksContainer(Date.now(), assigner, document.getElementById("current-tasks"));
        updateTasksContainer(Date.now()-assigner.cycleDuration, assigner, document.getElementById("previous-tasks"));
        updateTasksContainer(Date.now()+assigner.cycleDuration, assigner, document.getElementById("next-tasks"));
        updateDaysLeft(assigner.getDaysLeft(new Date()), document.getElementById("days-left"));
    </script>
</body>

</html>
